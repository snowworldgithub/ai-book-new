# Setup Guide

Complete setup guide for the Speckit + Docusaurus documentation system for the AI-Native Physical AI & Humanoid Robotics textbook.

## Prerequisites

Before setting up the documentation system, ensure you have:

- **Node.js**: Version 20.0 or higher
- **npm**: Version 8 or higher (usually comes with Node.js)
- **Git**: Version 2.13 or higher
- **A code editor** (VS Code recommended)
- **Access to command line/terminal**

### Verify Prerequisites

Check that you have the required tools installed:

```bash
# Check Node.js version (should be 20+)
node --version

# Check npm version
npm --version

# Check Git version
git --version
```

## Installation Steps

### 1. Clone or Create the Project

If you're starting from scratch:

```bash
npx create-docusaurus@latest my-robotics-docs classic
cd my-robotics-docs
```

If you're working with an existing repository:

```bash
git clone <your-repository-url>
cd <repository-directory>
```

### 2. Install Dependencies

Install all required dependencies:

```bash
npm install
```

This will install:
- Docusaurus core packages
- Documentation generation tools
- React components and utilities
- Development dependencies

### 3. Install Additional Dependencies for Speckit

Install packages needed for documentation generation:

```bash
npm install --save-dev jsdoc minami
npm install react-live fs-extra glob
```

### 4. Create Configuration Files

Create the Speckit configuration file:

```bash
# Create the configuration file
touch speckit.config.js
```

Add the following content to `speckit.config.js`:

```javascript
module.exports = {
  source: {
    include: [
      'src/',                    // Frontend source files
      'backend/',               // Backend API files
      'components/'             // Component files
    ],
    exclude: [
      'node_modules/',          // Exclude dependencies
      'dist/',                  // Exclude build output
      'build/',                 // Exclude build output
      'coverage/'               // Exclude test coverage
    ],
    includePattern: '.+\\.(js|jsx|ts|tsx|json|py)?$',
    excludePattern: '(^|\\/|\\\\)_'
  },
  opts: {
    destination: './specs/',     // Output directory for generated specs
    recurse: true,               // Recursively scan directories
    verbose: true,               // Show detailed output
    encoding: 'utf8',            // Source file encoding
    template: './node_modules/minami' // Template for generated docs
  },
  plugins: [
    'plugins/markdown',          // Parse markdown in comments
    'plugins/summarize',         // Generate summaries
    'plugins/advanced-types'     // Handle complex TypeScript types
  ],
  templates: {
    cleverLinks: true,
    monospaceLinks: false,
    default: {
      outputSourceFiles: true,
      includeDate: false,
      systemName: 'Physical AI & Humanoid Robotics',
      footer: 'Generated by Speckit + Docusaurus',
      copyright: 'Copyright 2025',
      linenums: true
    }
  }
};
```

### 5. Create the Generation Script

Create the script that will run the documentation generator:

```bash
mkdir -p scripts
touch scripts/generate-specs.js
```

Add the following content to `scripts/generate-specs.js`:

```javascript
const { exec } = require('child_process');
const fs = require('fs-extra');
const path = require('path');

async function generateSpecs() {
  console.log('üöÄ Starting Speckit documentation generation...');

  // Create specs directory if it doesn't exist
  await fs.ensureDir('./specs');
  console.log('üìÅ Specs directory prepared');

  // Run JSDoc to generate specs from code comments
  const jsdocConfig = path.join(__dirname, '../speckit.config.js');

  exec(`npx jsdoc -c ${jsdocConfig}`, (error, stdout, stderr) => {
    if (error) {
      console.error(`‚ùå Error generating specs: ${error.message}`);
      process.exit(1);
    }

    if (stderr) {
      console.warn(`‚ö†Ô∏è  Warnings during generation: ${stderr}`);
    }

    console.log(`‚úÖ Specs generated successfully!`);
    console.log(`üìÑ Output location: ./specs/`);

    if (stdout) {
      console.log(`üìù Generation log: ${stdout}`);
    }
  });
}

// Run the generation
generateSpecs().catch(error => {
  console.error('‚ùå Failed to run generation:', error);
  process.exit(1);
});
```

### 6. Update Package.json Scripts

Add the generation script to your `package.json`:

```json
{
  "scripts": {
    "docusaurus": "docusaurus",
    "start": "docusaurus start",
    "build": "docusaurus build",
    "swizzle": "docusaurus swizzle",
    "deploy": "docusaurus deploy",
    "clear": "docusaurus clear",
    "serve": "docusaurus serve",
    "write-translations": "docusaurus write-translations",
    "write-heading-ids": "docusaurus write-heading-ids",
    "generate:specs": "node scripts/generate-specs.js",
    "generate:specs:watch": "nodemon --watch 'src/**/*' --ext 'js,jsx,ts,tsx' --exec 'npm run generate:specs'"
  }
}
```

### 7. Configure Docusaurus

Update your `docusaurus.config.js` to include the additional plugins for specs, API, and guides:

```javascript
// Add to your existing docusaurus.config.js
module.exports = {
  // ... existing configuration ...

  plugins: [
    // ... existing plugins ...

    // Add plugins for different documentation sections
    [
      '@docusaurus/plugin-content-docs',
      {
        id: 'specs',
        path: 'specs',
        routeBasePath: 'specs',
        sidebarPath: require.resolve('./sidebars-specs.js'),
      },
    ],
    [
      '@docusaurus/plugin-content-docs',
      {
        id: 'api',
        path: 'api',
        routeBasePath: 'api',
        sidebarPath: require.resolve('./sidebars-api.js'),
      },
    ],
    [
      '@docusaurus/plugin-content-docs',
      {
        id: 'guides',
        path: 'guides',
        routeBasePath: 'guides',
        sidebarPath: require.resolve('./sidebars-guides.js'),
      },
    ],
  ],

  themeConfig: {
    // ... existing theme config ...

    algolia: {
      // Optional: Configure Algolia search
      appId: process.env.ALGOLIA_APP_ID,
      apiKey: process.env.ALGOLIA_API_KEY,
      indexName: 'speckit-docusaurus-docs',
      contextualSearch: true,
      searchPagePath: 'search',
    },
  },
};
```

### 8. Create Additional Sidebar Files

Create the sidebar configuration files that were referenced in the config:

**sidebars-specs.js:**
```javascript
// @ts-check

/** @type {import('@docusaurus/plugin-content-docs').SidebarsConfig} */
const sidebars = {
  specsSidebar: [
    {
      type: 'autogenerated',
      dirName: '.', // Generate sidebar for the specs directory
    },
  ],
};

module.exports = sidebars;
```

**sidebars-api.js:**
```javascript
// @ts-check

/** @type {import('@docusaurus/plugin-content-docs').SidebarsConfig} */
const sidebars = {
  apiSidebar: [
    {
      type: 'autogenerated',
      dirName: '.', // Generate sidebar for the api directory
    },
  ],
};

module.exports = sidebars;
```

**sidebars-guides.js:**
```javascript
// @ts-check

/** @type {import('@docusaurus/plugin-content-docs').SidebarsConfig} */
const sidebars = {
  guidesSidebar: [
    {
      type: 'autogenerated',
      dirName: '.', // Generate sidebar for the guides directory
    },
  ],
};

module.exports = sidebars;
```

## Environment Configuration

### 1. Create Environment File

Create a `.env` file in the project root (do not commit to version control):

```bash
touch .env
```

Add environment variables (if using Algolia search):

```env
ALGOLIA_APP_ID=your_algolia_app_id
ALGOLIA_API_KEY=your_algolia_api_key
ALGOLIA_INDEX_NAME=your_index_name
```

### 2. Update Git Ignore

Ensure sensitive files are not committed by updating `.gitignore`:

```gitignore
# Environment variables
.env
.env.local
.env.development.local
.env.test.local
.env.production.local

# Generated specs (if you don't want to commit them)
specs/

# IDE
.vscode/
.idea/

# OS
.DS_Store
Thumbs.db
```

## Verification Steps

### 1. Test the Development Server

Start the development server to verify basic functionality:

```bash
npm start
```

Your documentation site should be available at `http://localhost:3000`.

### 2. Test the Documentation Generator

Run the documentation generator to ensure it works:

```bash
npm run generate:specs
```

You should see output indicating successful generation, and a `specs/` directory should be created.

### 3. Build the Site

Test a production build:

```bash
npm run build
```

This should create a `build/` directory with the static site.

## Common Issues and Solutions

### Issue: "Command not found" when running npm commands

**Solution**: Ensure Node.js and npm are properly installed and in your PATH:
```bash
# Check installation
node --version
npm --version

# If not found, reinstall Node.js from nodejs.org
```

### Issue: Permission errors during installation

**Solution**:
- On Windows: Run Command Prompt as Administrator
- On macOS/Linux: Use `sudo` if necessary, or fix npm permissions

### Issue: Generation fails with syntax errors

**Solution**: Check that your source files have valid JavaScript/TypeScript syntax and properly formatted JSDoc comments.

### Issue: Site doesn't reflect changes

**Solution**: Clear the Docusaurus cache:
```bash
npm run clear
npm start
```

## Next Steps

After successful setup, you should:

1. **Add documentation to your code**: Start adding JSDoc comments to your functions and components
2. **Generate initial specs**: Run `npm run generate:specs` to create your first set of specifications
3. **Customize the site**: Modify the configuration, styling, and content to match your project
4. **Set up CI/CD**: Configure automated generation and deployment
5. **Add content**: Create additional documentation pages in the `docs/`, `guides/`, and `api/` directories

## Optional: Set up Development Tools

### Install Git Hooks (for automated generation)

If you want to automatically generate specs before commits:

```bash
# Install husky for git hooks
npm install --save-dev husky

# Add to package.json
{
  "scripts": {
    "prepare": "husky install"
  }
}
```

Create `.husky/pre-commit`:
```bash
#!/usr/bin/env sh
. "$(dirname "$0")/_/husky.sh"

npm run generate:specs
git add specs/
```

### Install Code Quality Tools

```bash
npm install --save-dev eslint prettier @docusaurus/eslint-plugin
```

Now your Speckit + Docusaurus documentation system is fully set up and ready to use!