# Running the Generator

Learn how to run the Speckit generator to automatically create specifications from your codebase.

## Basic Usage

### Command Line

Run the generator using npm script:

```bash
npm run generate:specs
```

Or directly with Node.js:

```bash
node scripts/generate-specs.js
```

### Direct JSDoc Usage

You can also run JSDoc directly if you need more control:

```bash
npx jsdoc -c jsdoc.config.js
```

## Configuration Options

### Command Line Flags

The generator supports various command line options:

```bash
# Verbose output for debugging
npm run generate:specs -- --verbose

# Specify a different output directory
npm run generate:specs -- --destination ./custom-specs

# Include additional source directories
npm run generate:specs -- --source ./src ./additional-source
```

### Configuration File

The generator reads from `speckit.config.js` or `jsdoc.config.js`:

```javascript
module.exports = {
  source: {
    include: ['src/', 'backend/'],    // Source directories
    exclude: ['node_modules/'],       // Excluded directories
    includePattern: '.+\\.js(doc|x)?$', // File patterns to include
    excludePattern: '(^|\\/|\\\\)_'    // File patterns to exclude
  },
  opts: {
    destination: './specs/',          // Output directory
    recurse: true,                    // Recursively scan directories
    verbose: true,                    // Show detailed output
    encoding: 'utf8',                 // Source encoding
    template: './node_modules/minami' // Template to use
  }
};
```

## Output Formats

### Default Output

By default, Speckit generates:

- **Markdown files** in the `specs/` directory
- **API documentation** from route definitions
- **Component specs** from React components
- **Module documentation** from code structure

### Custom Templates

You can customize the output format using templates:

```javascript
// In speckit.config.js
templates: {
  default: {
    outputSourceFiles: true,
    includeDate: false,
    systemName: 'My Robotics Project',
    footer: 'Generated by Speckit + Docusaurus',
    copyright: 'Copyright My Company',
    linenums: true,
  }
}
```

## Integration with Build Process

### Pre-build Hook

Add generation to your build process:

```json
{
  "scripts": {
    "prebuild": "npm run generate:specs",
    "build": "docusaurus build"
  }
}
```

### Watch Mode

For development, you can set up a watch mode:

```json
{
  "scripts": {
    "generate:watch": "nodemon --watch 'src/**/*' --exec 'npm run generate:specs'"
  }
}
```

## Advanced Usage

### Filtering Output

Generate specs for specific parts of your codebase:

```bash
# Generate only API specs
npx jsdoc -c jsdoc.config.js -p 'src/api'

# Generate only component specs
npx jsdoc -c jsdoc.config.js -p 'src/components'
```

### Multiple Configurations

Use different configurations for different purposes:

```bash
# Generate full specs
npm run generate:specs:full

# Generate minimal specs for CI
npm run generate:specs:minimal
```

With corresponding scripts in package.json:

```json
{
  "scripts": {
    "generate:specs:full": "npx jsdoc -c jsdoc.full.config.js",
    "generate:specs:minimal": "npx jsdoc -c jsdoc.minimal.config.js"
  }
}
```

## Monitoring and Validation

### Generation Logs

The generator outputs logs to help with debugging:

```bash
# View detailed logs
npm run generate:specs -- --verbose

# Save logs to file
npm run generate:specs -- --verbose > generation.log 2>&1
```

### Validation

Validate generated specs before deployment:

```bash
# Check for broken links
npm run docusaurus write-heading-ids

# Validate markdown syntax
npx markdownlint-cli specs/**/*.md
```

## Troubleshooting

### Common Issues

**Issue**: Generator doesn't find any files
**Solution**: Check that your source directories are correctly specified in the configuration

**Issue**: Generation fails with syntax errors
**Solution**: Check that your source files have valid JavaScript/TypeScript syntax

**Issue**: Generated specs are empty
**Solution**: Verify that your code has proper JSDoc comments

### Debugging Steps

1. **Check configuration**: Verify your `speckit.config.js` settings
2. **Verify permissions**: Ensure the generator can read source files and write to output directory
3. **Validate syntax**: Check that source files have valid syntax
4. **Review comments**: Ensure JSDoc comments follow the correct format

### Performance Tips

- Limit the number of files scanned by being specific with include/exclude patterns
- Use incremental generation when possible
- Exclude large binary files or build directories
- Consider using a more selective pattern if generation is slow